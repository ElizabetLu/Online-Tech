<section>
  <div class="header">
    <button class="back" (click)="back()">‚Üê Back</button>
    <h1>Registration</h1>
  </div>

  <div class="registration-container">
    <form class="registration-form" (ngSubmit)="register(registerForm)" #registerForm="ngForm">
      <div class="form-group">
        <label class="form-label">First Name *</label>
        <input
          type="text"
          name="firstName"
          [(ngModel)]="formData.firstName"
          required
          minlength="2"
          maxlength="50"
          #firstName="ngModel"
          [ngClass]="{
            success: firstName.touched && firstName.valid,
            error: firstName.touched && firstName.invalid
          }"
          placeholder="Enter your first name"
        />
        <span class="error-message" *ngIf="firstName.touched && firstName.errors?.['required']"
          >First name is required</span
        >
        <span class="error-message" *ngIf="firstName.touched && firstName.errors?.['minlength']"
          >First name must be at least 2 characters</span
        >
      </div>

      <div class="form-group">
        <label class="form-label">Last Name *</label>
        <input
          type="text"
          name="lastName"
          [(ngModel)]="formData.lastName"
          required
          minlength="2"
          maxlength="50"
          #lastName="ngModel"
          [ngClass]="{
            success: lastName.touched && lastName.valid,
            error: lastName.touched && lastName.invalid
          }"
          placeholder="Enter your last name"
        />
        <span class="error-message" *ngIf="lastName.touched && lastName.errors?.['required']"
          >Last name is required</span
        >
        <span class="error-message" *ngIf="lastName.touched && lastName.errors?.['minlength']"
          >Last name must be at least 2 characters</span
        >
      </div>

      <div class="form-group">
        <label class="form-label">Email *</label>
        <input
          type="email"
          name="email"
          [(ngModel)]="formData.email"
          required
          email
          #email="ngModel"
          [ngClass]="{
            success: email.touched && email.valid,
            error: email.touched && email.invalid
          }"
          placeholder="example@email.com"
        />
        <span class="error-message" *ngIf="email.touched && email.errors?.['required']"
          >Email is required</span
        >
        <span class="error-message" *ngIf="email.touched && email.errors?.['email']"
          >Enter a valid email address</span
        >
      </div>

      <div class="form-group">
        <label class="form-label">Password *</label>
        <div class="password-wrapper">
          <input
            [type]="showPassword ? 'text' : 'password'"
            name="password"
            [(ngModel)]="formData.password"
            required
            minlength="8"
            #password="ngModel"
            [ngClass]="{
              success: password.touched && password.valid,
              error: password.touched && password.invalid
            }"
            placeholder="Min 8 characters"
          />
          <button type="button" class="toggle-password" (click)="showPassword = !showPassword">
            <i [class]="showPassword ? 'fa fa-eye' : 'fa fa-eye-slash'"></i>
          </button>
        </div>
        <span class="error-message" *ngIf="password.touched && password.errors?.['required']"
          >Password is required</span
        >
        <span class="error-message" *ngIf="password.touched && password.errors?.['minlength']"
          >Password must be at least 8 characters</span
        >
      </div>

      <div class="form-group">
        <label class="form-label">Confirm Password *</label>
        <div class="password-wrapper">
          <input
            [type]="showConfirmPassword ? 'text' : 'password'"
            name="confirmPassword"
            [(ngModel)]="formData.confirmPassword"
            required
            #confirmPassword="ngModel"
            [ngClass]="{
              success:
                confirmPassword.touched &&
                confirmPassword.valid &&
                formData.password === formData.confirmPassword,
              error:
                confirmPassword.touched &&
                (confirmPassword.invalid || formData.password !== formData.confirmPassword)
            }"
            placeholder="Confirm your password"
          />
          <button
            type="button"
            class="toggle-password"
            (click)="showConfirmPassword = !showConfirmPassword"
          >
            <i [class]="showConfirmPassword ? 'fa fa-eye' : 'fa fa-eye-slash'"></i>
          </button>
        </div>
        <span
          class="error-message"
          *ngIf="confirmPassword.touched && confirmPassword.errors?.['required']"
          >Please confirm your password</span
        >
        <span
          class="error-message"
          *ngIf="confirmPassword.touched && formData.password !== formData.confirmPassword && !confirmPassword.errors?.['required']"
          >Passwords do not match</span
        >
      </div>

      <div class="form-group">
        <label class="form-label">Age *</label>
        <input
          type="number"
          name="age"
          [(ngModel)]="formData.age"
          required
          min="18"
          max="120"
          #age="ngModel"
          [ngClass]="{
            success: age.touched && age.valid,
            error: age.touched && age.invalid
          }"
          placeholder="18"
        />
        <span class="error-message" *ngIf="age.touched && age.errors?.['required']"
          >Age is required</span
        >
        <span class="error-message" *ngIf="age.touched && age.errors?.['min']"
          >You must be at least 18 years old</span
        >
      </div>

      <div class="form-group">
        <label class="form-label">Address *</label>
        <input
          type="text"
          name="address"
          [(ngModel)]="formData.address"
          required
          minlength="5"
          #address="ngModel"
          [ngClass]="{
            success: address.touched && address.valid,
            error: address.touched && address.invalid
          }"
          placeholder=""
        />
        <span class="error-message" *ngIf="address.touched && address.errors?.['required']"
          >Address is required</span
        >
        <span class="error-message" *ngIf="address.touched && address.errors?.['minlength']"
          >Address must be at least 5 characters</span
        >
      </div>

      <div class="form-group">
        <label class="form-label">Phone *</label>
        <input
          type="tel"
          name="phone"
          [(ngModel)]="formData.phone"
          (input)="onPhoneInput($event)"
          required
          pattern="[+][0-9]{12}"
          #phone="ngModel"
          [ngClass]="{
            success: phone.touched && phone.valid,
            error: phone.touched && phone.invalid
          }"
          placeholder=""
        />
        <span class="help-text">Format: +[country code][number] (12 digits total)</span>
        <span class="error-message" *ngIf="phone.touched && phone.errors?.['required']"
          >Phone is required</span
        >
        <span class="error-message" *ngIf="phone.touched && phone.errors?.['pattern']"
          >Enter a valid phone number (e.g., +995599123456)</span
        >
      </div>

      <div class="form-group">
        <label class="form-label">Zipcode *</label>
        <input
          type="text"
          name="zipcode"
          [(ngModel)]="formData.zipcode"
          (input)="onZipcode($event)"
          required
          pattern="[0-9]{4,10}"
          #zipcode="ngModel"
          [ngClass]="{
            success: zipcode.touched && zipcode.valid,
            error: zipcode.touched && zipcode.invalid
          }"
          placeholder=""
        />
        <span class="error-message" *ngIf="zipcode.touched && zipcode.errors?.['required']"
          >Zipcode is required</span
        >
        <span class="error-message" *ngIf="zipcode.touched && zipcode.errors?.['pattern']"
          >Zipcode must be 4-10 digits</span
        >
      </div>

      <div class="form-group">
        <label class="form-label">Avatar URL *</label>
        <input
          type="url"
          name="avatar"
          [(ngModel)]="formData.avatar"
          required
          pattern="https?://.+"
          #avatar="ngModel"
          [ngClass]="{
            success: avatar.touched && avatar.valid,
            error: avatar.touched && avatar.invalid
          }"
          placeholder=""
        />
        <span class="error-message" *ngIf="avatar.touched && avatar.errors?.['required']"
          >Avatar URL is required</span
        >
        <span class="error-message" *ngIf="avatar.touched && avatar.errors?.['pattern']"
          >Enter a valid URL (must start with http:// or https://)</span
        >
      </div>

      <div class="form-group gender-group">
        <label class="form-label">Gender *</label>
        <div class="radio-group">
          <div class="form-check">
            <input
              type="radio"
              name="gender"
              id="male"
              value="MALE"
              [(ngModel)]="formData.gender"
              required
            />
            <label class="form-check-label" for="male">Male</label>
          </div>
          <div class="form-check">
            <input
              type="radio"
              name="gender"
              id="female"
              value="FEMALE"
              [(ngModel)]="formData.gender"
              required
            />
            <label class="form-check-label" for="female">Female</label>
          </div>
        </div>
      </div>

      <button
        type="submit"
        class="submit-btn"
        [disabled]="registerForm.invalid || formData.password !== formData.confirmPassword"
      >
        Register
      </button>

      <p class="signin-link">Already have an account? <a routerLink="/signin">Sign in here</a></p>
    </form>
  </div>

  <button class="scroll-btn" (click)="handleScroll()" [class.scroll-up]="!isScrollingDown">
    <span class="arrow-icon">
      <i [class]="isScrollingDown ? 'fa fa-chevron-down' : 'fa fa-chevron-up'"></i>
    </span>
  </button>
</section>
